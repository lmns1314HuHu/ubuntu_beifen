window.Messenger=function(){function t(t,e){var a="";if(arguments.length<2?a="target error - target and name are both requied":"object"!=typeof t?a="target error - target itself must be window object":"string"!=typeof e&&(a="target error - target name must be string type"),a)throw new Error(a);this.target=t,this.name=e}function e(t,e){this.targets={},this.name=t,this.listenFunc=[],d=e||d,"string"!=typeof d&&(d=d.toString()),this.initListen()}function a(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}function n(t){return a({},t||{})}function i(t){var e=window.location.search,a=e.match(/&*daid=(\d+)&*/),n=e.match(/&*dacssclass=(\w+)&*/),i={command:"comforum_adsense",data:{id:a&&a[1]?a[1]:0,cssclass:n&&n[1]?n[1]:"",status:t.result,height:t.height}};return i=JSON.stringify(i)}var d="[PROJECT_NAME]",r="postMessage"in window;t.prototype.send=r?function(t){this.target.postMessage(d+t,"*")}:function(t){var e=window.navigator[d+this.name];if("function"!=typeof e)throw new Error("target callback function is not defined");e(d+t,window)},e.prototype.addTarget=function(e,a){var n=new t(e,a);this.targets[a]=n},e.prototype.initListen=function(){var t=this,e=function(e){"object"==typeof e&&e.data&&(e=e.data),e=e.slice(d.length);for(var a=0;a<t.listenFunc.length;a++)t.listenFunc[a](e)};r?"addEventListener"in document?window.addEventListener("message",e,!1):"attachEvent"in document&&window.attachEvent("onmessage",e):window.navigator[d+this.name]=e},e.prototype.listen=function(t){this.listenFunc.push(t)},e.prototype.clear=function(){this.listenFunc=[]},e.prototype.send=function(t){var e,a=this.targets;for(e in a)a.hasOwnProperty(e)&&a[e].send(t)};var o=new e("adIframe","checkStatus");return o.addTarget(window.parent,"adCenter"),e.success=function(t){o.targets.adCenter.send(i(a(n(t),{result:"success"})))},e.fail=function(t){o.targets.adCenter.send(i(a(n(t),{result:"fail"})))},e}(),window.AdsenseTrack=function(t){var e=function(){var t=location.search,e=new Object;if(-1!=t.indexOf("?")){var a=t.substr(1);strs=a.split("&");for(var n=0;n<strs.length;n++)e[strs[n].split("=")[0]]=strs[n].split("=")[1]}return e},a=function(t,e,a,n){t&&(t.attachEvent?t.attachEvent("on"+e,a):t.addEventListener&&t.addEventListener(e,a,n))},n=function(t,e){for(var a=new Array,n=document.getElementsByTagName(t),i="",d=new RegExp("(^|\\s)"+e+"(\\s|$)"),r=0,o=n.length;o>r;r++)i=n[r].className,d.test(i)&&a.push(n[r]);return a},i=i||{};i.stats=i.stats||{},i.stats.track=function(t){if(document.images){var e=new Image;window["bd_pv_"+(new Date).getTime()]=e;var a="http://static.tieba.baidu.com/tb/img/track.gif?",n=[];t.hasOwnProperty("trackUrl")&&(a=t.trackUrl);for(var i in t)t.hasOwnProperty(i)&&"trackUrl"!=i&&n.push(i+"="+encodeURIComponent(t[i]));a+=n.join("&"),e.src=a+"&t="+(new Date).getTime(),e=null}};var d="iframe",r="tbda",o=e(),s=o.dapage||o.da_page||"",c=o.fid||"",u=o.tid||"",p=o.dacuid||"",_=o.dauid||"",f=o.dabaiduid||"",g=(o.datypeid||"",o.daid||o.da_obj_id||""),l=decodeURIComponent(o.daname||""),h=o.dagoodid||o.da_good_id||"",m=decodeURIComponent(o.dafirstname||o.da_first_name||""),w=decodeURIComponent(o.dasecondname||o.da_second_name||""),v=o.dacpid||o.da_cpid||"",y=o.daabtest||o.da_abtest||"",b=o.daprice||o.da_price||"",k=o.daverify||o.da_verify||"",E=o.daextinfo||o.da_ext_info||"",A=o.daplanid||"",C=o.dauserid||"",T=o.dathrowtype||"",j=(decodeURIComponent(o.adforumname||""),{client_type:"pc_web",task:r,da_task:r,page:s,da_page:s,locate:d,da_locate:d,da_obj_id:g,fid:c,tid:u,da_good_id:h,da_ext_info:E,da_price:b,da_verify:k,cuid:p,uid:_,baiduid:f,da_obj_name:l,da_first_name:m,da_second_name:w,da_cpid:v,da_abtest:y,da_throw_type:T}),U={trackUrl:"http://tieba.baidu.com/billboard/pushlog/?",da_task:r,da_page:s,da_locate:d,da_client_type:"PC",da_obj_id:g,da_fid:c,da_tid:u,da_good_id:h,da_ext_info:E,da_plan_id:A,da_user_id:C,da_price:b,da_verify:k,da_cuid:p,da_uid:_,da_baiduid:f,da_cpid:v,da_throw_type:T},N=/AppleWebKit.*Mobile/i.test(navigator.userAgent)||/Android/i.test(navigator.userAgent);N&&(j.client_type="wap_smart",j.da_client_type="wap_smart",U.client_type="WAP",U.da_client_type="WAP");var O=function(t,e){N&&(t.preventDefault?t.preventDefault():t.returnValue=!1,setTimeout(function(){window.open(e.getAttribute("href"),"_parent")},500)),j.type="click",j.da_type="click",i.stats.track(j),U.da_type="click",i.stats.track(U)},P=function(){a(document.getElementsByTagName("body")[0],"click",function(t){t=t||window.event;var e=t.target||t.srcElement,a="",n="";do a=e.tagName,n=e.className;while("A"!==a&&(e=e.parentNode));"A"==a&&/j_tb/.test(n)&&O(t,e)},!1),j.type="show",j.da_type="show",i.stats.track(j),U.da_type="show",i.stats.track(U)},R=0;return a(t,"load",function(){R=1,P("load")},!1),a(t,"pagehide",function(){R=0},!1),a(t,"pageshow",function(){R||P("pageshow")},!1),{addEvent:a,getRequest:e,getTagByClass:n,setupTrack:O,version:"1.0.1"}}(this);